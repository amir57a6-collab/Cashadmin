<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Manage Tasks</title>
    <style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');body{font-family:'Inter',sans-serif;background-color:#111827;color:#d1d5db;margin:0}.container{display:flex;min-height:100vh}.sidebar{width:250px;background-color:#1f2937;padding:1.5rem}.sidebar-header{font-size:1.5rem;font-weight:700;color:#fff;margin-bottom:2rem}.sidebar-nav a{display:block;color:#9ca3af;text-decoration:none;padding:.75rem 1rem;border-radius:.5rem;margin-bottom:.5rem;font-weight:500}.sidebar-nav a.active{background-color:#10b981;color:#fff}.main-content{flex:1;padding:2.5rem;overflow-y:auto}.main-header h1{font-size:2rem;font-weight:700;color:#fff;margin:0}.form-container{background-color:#1f2937;padding:2rem;border-radius:.75rem;margin-top:2rem;max-width:700px}.form-group{margin-bottom:1.5rem}.form-group label{display:block;font-weight:500;color:#9ca3af;margin-bottom:.5rem}.form-group input,.form-group select,.form-group textarea{width:100%;padding:.75rem;background-color:#374151;border:1px solid #4b5563;border-radius:.5rem;color:#d1d5db;box-sizing:border-box}.form-group textarea{min-height:100px;resize:vertical}.submit-btn{background-color:#10b981;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:.5rem;cursor:pointer;font-weight:600}</style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h1 class="sidebar-header">Task Manager</h1>
            <nav class="sidebar-nav">
                <a href="dashboard.html">Dashboard</a><a href="users.html">Users</a><a href="manage-tasks.html" class="active">Create Task</a><a href="task-list.html">Task List</a><a href="withdrawals.html">Withdrawals</a><a href="settings.html">Settings</a>
            </nav>
        </aside>
        <main class="main-content">
            <header class="main-header"><h1>Create New Task</h1></header>
            <form class="form-container" id="task-form">
                <div class="form-group"><label for="task-title">Task Title</label><input type="text" id="task-title" placeholder="e.g., Video Review" required></div>
                <div class="form-group"><label for="task-desc">Description</label><textarea id="task-desc" placeholder="A short summary of the task." required></textarea></div>
                <div class="form-group"><label for="task-reward">Reward Amount ($)</label><input type="number" id="task-reward" placeholder="e.g., 5.00" step="0.01" required></div>
                <div class="form-group"><label for="task-image-url">Image URL (Optional)</label><input type="url" id="task-image-url" placeholder="https://example.com/image.png"></div>
                <div class="form-group"><label for="task-link">Task Link (Redirect URL)</label><input type="url" id="task-link" placeholder="https://youtube.com/watch?v=..." required></div>
                <div class="form-group"><label for="task-category">Category (for icon)</label>
                    <select id="task-category"><option value="default">Default</option><option value="video">Video</option><option value="download">Download</option><option value="survey">Survey</option></select>
                </div>
                <div class="form-group"><label for="task-instructions">Instructions</label><textarea id="task-instructions" placeholder="Detailed step-by-step instructions for the user." required></textarea></div>
                <button type="submit" class="submit-btn">Create Task</button>
            </form>
        </main>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
        const firebaseConfig = { apiKey: "AIzaSyBNy8sZGAKh3Ika7O7F-NLZZZWAU-j2B0A", authDomain: "cashcoinser.firebaseapp.com", projectId: "cashcoinser", storageBucket: "cashcoinser.appspot.com", messagingSenderId: "179560740788", appId: "1:179560740788:web:4d6f5678e80f86899364e1" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const ADMIN_EMAIL = "amir57a6@gmail.com";
        onAuthStateChanged(auth, user => { if (!user || user.email !== ADMIN_EMAIL) window.location.href = 'index.html'; });
        document.getElementById('task-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const taskData = {
                title: document.getElementById('task-title').value,
                description: document.getElementById('task-desc').value,
                reward: parseFloat(document.getElementById('task-reward').value),
                imageUrl: document.getElementById('task-image-url').value || "",
                taskLink: document.getElementById('task-link').value,
                category: document.getElementById('task-category').value,
                instructions: document.getElementById('task-instructions').value,
                createdAt: serverTimestamp()
            };
            try { await addDoc(collection(db, "tasks"), taskData); alert("Task created successfully!"); e.target.reset(); } catch (error) { alert("Error: " + error.message); }
        });
    </script>
</body>
</html>